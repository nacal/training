
## 座学2: コンテナから学ぶ標準化と抽象化

コンテナがもたらしたものは、  
標準化と抽象化がもたらしたもの、と言い換えられます。
コンテナが、何を標準化、抽象化したのでしょう？  
見ていきましょう。  

### 標準化: コンテナの規格を定め世界中の人で利用した

コンテナの設計を規格とし、世界中の人で共有することにより、
コンテナを作る人、運ぶ人、利用する人全てにメリットを与えました。
コンテナ作成者は「ISO 規格のコンテナ」を作るだけで良くなり、  
コンテナを運ぶ人は「ISO 規格のコンテナ」を運ぶための船を作ればよくなり、  
コンテナで荷物を運ぶ人は「ISO 規格のコンテナ」に詰め込むことができれば荷物を安く、スピーディーに運ぶことができるようになりました。

このように、とある仕組みをみんなで共有し、製品開発に利用する仕組みを「標準化」と呼びます。  
コンピュータの部品やネットワークの仕組みなど、インターネットの世界には実に多くのものが標準化されています。  


### 標準化するといいこと

#### 1. 世界中の企業が開発に参加できる

コンテナが標準化されたことにより、コンテナの箱自体や貨物船やクレーンなどの周辺環境の開発が進みました。  
これは、世界中の企業が開発に参加できるようになったことにより、競争原理を用いてさらに進みました。  

同様のことがネットワークやアプリケーションの世界でも起こっています。  

ネットワークは、通信の仕組みをプロトコルという形で標準化しています。  
プロトコルの例として、HTTP, TCP, IP などがあります。  

例えば、Web ページを閲覧するときにバックエンドの HTTP サーバを意識することはありませんよね？
nginx で配信されているから nginx 用のブラウザを利用したりはしないはずです。  
これは、HTTP という標準化されたプロトコルで会話をしているからです。  
様々な特色を持った HTTP サーバが世の中にはありますが、  
これは HTTP というプロトコルが世界的に標準化され、共有されているからできることなのです。  

#### 2. 様々なコストが下がる

コンテナなどの標準化されたものを各社が製造すると、それぞれに特色が無くなってきます。  

そうなると、大量生産によるコスト最適化が行われ、結果的に製品の値段が下がるというメリットがあります。  
この「どの製品を買ってもほぼ違いはない」という状態を特に「コモディティ化」とも表現します。  

HTTP を例に取りましょう。  
HTTP サーバを作ったときに、ちゃんと動くかテストがしたくなりますね。  
しかし、これが標準化されていないプロトコルだったとしたら、テストするシステムを一から作成する必要があります。  
HTTP プロトコルに沿ってサーバを作っていれば、世の中にある HTTP サーバをテストしてくれる洗練されたツールを利用することができます。  
結果として、テストするコストやサーバの製作コストが下がることになります。  

### 抽象化: 貨物船はコンテナの中身を知らない

コンテナの中に入っている荷物は、コンテナを運ぶ人は何も知りません、むしろ、知る必要がないのです。  

バナナの詰まったコンテナの上に自家用車を積んだコンテナを載せても、バナナがぺしゃんこになることはありません。
コンテナの中身が衣料品でパンパンだったとしても、クッキー1枚しか入っていなかったとしても、コンテナは世界中に運ばれていきます。  

コンテナ規格では、中身は○○kg の荷物まで、温度は○○℃ に耐えられるもの、というふうに、  
中身に対するスペックも定められています。  

荷物を積む人は、そのスペックさえ守れば荷物を運ぶことができ、
荷物を運ぶ人は、スペックに合った荷物なら何でも運ぶことができるようになったのです。  


### 抽象化するといいこと

#### 1. シンプルになる

抽象化の外と中でのやり取りが簡単になります。  
コンテナの例だと、積載する貨物が規定を満たしていれば、どんなものでも運べるようになります。  
ということは、 運べるかどうかの判断が定量的評価になるため、判断がしやすくなります。  
シンプルになりますね。

#### 2. 責任範囲が明確になる

コンテナができる前は、運べる荷物の判断ができなかったため、  
運搬における破損事故の責任が、送る側と運ぶ側どちらにあるのかが曖昧でした。  
そのため、運ぶ側がやたらと厳しい基準を設けたり、そもそも運ぶことのできない荷物ができてしまったりしました。  
コンテナに抽象化することで、コンテナ外に及ぶ事故は運ぶ側の責任、  
コンテナ内での破損事故は送る側の責任であるというふうに、  
責任の範囲がコンテナの中と外で明確に分離されました。  

同様のことは、ソフトウェアの文脈でも起こっています。

ライブラリのパブリックメソッドを適切に利用して発生したバグはライブラリのバグ、  
プライベートメソッドを使ったり、引数に意図しない型の変数を与えた場合に生じたバグは利用者側のバグであるといった、  
バグの原因はどちらにあるのか？といった問題を抽象化することで分離できています。  
API やネットワークプロトコルでも上記と全く同じことが言えます。  

##### おまけ: 抽象化の注意点

抽象化は便利な概念ですが、やり過ぎには注意です。

以下にやり過ぎな抽象化のケースを紹介します。

全く関連性がない A と B のタスクの中のコアな処理が、形が似ていたため抽象化してひとつのクラスにまとめました。  
B の変更をするためにクラスの中身を変更したら、A で変えてはいけない処理を変えてしまったため事故が起こってしまいました。  

抽象化する際は、機械的な関連性だけでなく意味の関連性も含めて、他人に優しい抽象化を心がけましょう。
