### 演習3 クラウドを触ってみる

習うより慣れろなので、クラウドを実際に触ってみましょう。  

### メンター準備

AWS で以下の準備をしていることを想定しています。  

- us-east-1 のみ扱える Role を作成し、IAM ユーザーを参加させている
- vpc, subnet (training-private, training-public) を用意している
- 踏み台サーバを用意している

### 決まりごと

多少お金のかかることだったり、本番系が乗っかっている場所を利用するため、  
少し決まりごとを設けさせてもらいます。   
以下の決まりごとを守れば、許可なしに自由に使ってもらって大丈夫です。

#### リージョンは us-east-1 のみ利用する

AWS では、いろいろな土地にサーバが置いてあり、それぞれを自由に選んで使うことができます。  
東京リージョンという、日本のどこかにかにあるリージョンもあります。  
今回は、バージニア州にある「us-east-1」のみが利用できます。

#### 踏み台サーバは消さない、いじらない

ssh ログインするための踏み台サーバを用意してあります。  
みんなで利用するものなので、消さないでおきましょう。  

### 外部アクセスは確認してから

外部からアクセスする設定を行うことができます。  
しかし、危険な設定もあるので、一度メンターにレビューをもらってから設定をしてください。  
外部へアクセスしない設定なら、何をやっても大丈夫です。  

### 研修が終わったら消す

研修が終わったら、退勤前に作成したリソースは自分で削除しましょう。  
残っていたものはメンターが削除します。  

## 演習 3.1 は社内環境とのつなぎ込みであるため削除いたしました

## 演習3.2 作成したインスタンスを壊してみる

作成できたインスタンスを、中身を書き換えて起動できないように壊してみましょう。  
どうやれば起動できないまでに破壊できるか調べてみましょう。  
ssh ログインしている状態で破壊したらどうなるのか見てみましょう。  
Running の状態なのに、ssh できない、または ssh できるけど何もできない状態にしてください。  
無事破壊できたらお知らせください。  
踏み台を壊さないように気をつけて！  

## 演習3.3 複数のシステムを繋いでみる

複数のインスタンスを作成して、相互に通信してみましょう。  

### 演習3.3.1 2つのインスタンスで通信してみる

インスタンスを2つ起動して、お互いで通信してみましょう。  
nginx をインストールして curl してみるなどで大丈夫です。  
通信できたら完了です。  


### 演習3.3.2 RDS を利用してアプリケーションを動かしてみる

DB を簡単に構築できる RDS というサービスがあります。  
こちらを利用して、DB を利用するサービスを動かしてみましょう。  
Rails アプリでも、Wordpress でもなんでも大丈夫です。  
`ssh ubuntu@xx.xx.xx.xx -L [Macのポート]:[インスタンスのIP]:[アプリ側ポート]` でフォワーディングして、`http://localhost:[Macのポート]` でアクセスできたら完了です。

### 演習3.3.3 アプリケーションを外部疎通させる

3.3.2 のアプリケーションを外部疎通させましょう。  
training-public サブネットに、ロードバランサとなるコンポーネントを起動させ、アプリケーションにアクセスしてください。  
こちらはパブリックの IP を付けることが必要となります。声をかけてください。  
接続できたら OK です。  

## 演習3.4 CUI からインスタンスを作ってみる

AWS は API を持っているので、いろいろなアプリケーションから実行することができます。  
AWS がターミナルから利用するクライアントを提供しているため、それを使ってみましょう。  
演習3.4 に取り掛かる際に、必要になるトークンをお渡ししますので、声をかけてください。  
インスタンスが起動できたら完了です。  

## 演習3.5 プログラムから RDS を起動して DB に繋いでみる

AWS は、各言語ごとに sdk (software development kit) を用意しています。  
好きな言語で、RDS を起動して DB に接続するプログラムを書いてみましょう。  
プログラムが動作したら完了です。  

## 演習3.6 CDK を使ってみる

CDK と呼ばれる、AWS でのインフラ構築に便利なキットがあります。  
これを使っていろいろやってみましょう。何をやってみても大丈夫です。  
なにかを構築したら完了です。

## 演習3.7 ユーザーデータを使ってみる
ユーザーデータという、起動時にあれこれしてくれるように設定できるスクリプトを流すことができます。  
これを指定して、希望するアプリケーションがインストールされている状態のインスタンスを作ってみましょう。  

## 演習3.7 ネットワークを作ってみる

VPC という機能で、隔離したネットワークを構築できます。  
新しい VPC を作成して、自分のネットワークにインスタンスを起動してインターネットから ssh してみましょう。  
ssh できたら完了です。  

## 演習3.8 いろいろなサービスを使ってみる

好きなサービスを使ってみてください！  
使ってみたサービスと、その感想を教えてください。  
